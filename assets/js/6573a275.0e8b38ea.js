(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[6019],{1909:function(e,t,s){var r,a;!function(i,n){"use strict";var l=4294967296,o=9007199254740992;(a="function"==typeof(r={encode:function(e){var t,s=new ArrayBuffer(256),r=new DataView(s),a=0;function i(e){for(var i=s.byteLength,n=a+e;i<n;)i<<=1;if(i!==s.byteLength){var l=r;s=new ArrayBuffer(i),r=new DataView(s);for(var o=a+3>>2,d=0;d<o;++d)r.setUint32(d<<2,l.getUint32(d<<2))}return t=e,r}function d(){a+=t}function c(e){d(i(1).setUint8(a,e))}function h(e){for(var t=i(e.length),s=0;s<e.length;++s)t.setUint8(a+s,e[s]);d()}function g(e,t){t<24?c(e<<5|t):t<256?(c(e<<5|24),c(t)):t<65536?(c(e<<5|25),function(e){d(i(2).setUint16(a,e))}(t)):t<4294967296?(c(e<<5|26),function(e){d(i(4).setUint32(a,e))}(t)):(c(e<<5|27),function(e){var t=e%l,s=(e-t)/l,r=i(8);r.setUint32(a,s),r.setUint32(a+4,t),d()}(t))}if(function e(t){var s;if(!1===t)return c(244);if(!0===t)return c(245);if(null===t)return c(246);if(t===n)return c(247);switch(typeof t){case"number":if(Math.floor(t)===t){if(0<=t&&t<=o)return g(0,t);if(-o<=t&&t<0)return g(1,-(t+1))}return c(251),function(e){d(i(8).setFloat64(a,e))}(t);case"string":var r=[];for(s=0;s<t.length;++s){var l=t.charCodeAt(s);l<128?r.push(l):l<2048?(r.push(192|l>>6),r.push(128|63&l)):l<55296?(r.push(224|l>>12),r.push(128|l>>6&63),r.push(128|63&l)):(l=(1023&l)<<10,l|=1023&t.charCodeAt(++s),l+=65536,r.push(240|l>>18),r.push(128|l>>12&63),r.push(128|l>>6&63),r.push(128|63&l))}return g(3,r.length),h(r);default:var u;if(Array.isArray(t))for(g(4,u=t.length),s=0;s<u;++s)e(t[s]);else if(t instanceof Uint8Array)g(2,t.length),h(t);else{var m=Object.keys(t);for(g(5,u=m.length),s=0;s<u;++s){var f=m[s];e(f),e(t[f])}}}}(e),"slice"in s)return s.slice(0,a);for(var u=new ArrayBuffer(a),m=new DataView(u),f=0;f<a;++f)m.setUint8(f,r.getUint8(f));return u},decode:function(e,t,s){var r=new DataView(e),a=0;function i(e,t){return a+=e,t}function o(t){return i(t,new Uint8Array(e,a,t))}function d(){return i(1,r.getUint8(a))}function c(){return i(2,r.getUint16(a))}function h(){return i(4,r.getUint32(a))}function g(){return 255===r.getUint8(a)&&(a+=1,!0)}function u(e){if(e<24)return e;if(24===e)return d();if(25===e)return c();if(26===e)return h();if(27===e)return h()*l+h();if(31===e)return-1;throw"Invalid length encoding"}function m(e){var t=d();if(255===t)return-1;var s=u(31&t);if(s<0||t>>5!==e)throw"Invalid indefinite length element";return s}function f(e,t){for(var s=0;s<t;++s){var r=d();128&r&&(r<224?(r=(31&r)<<6|63&d(),t-=1):r<240?(r=(15&r)<<12|(63&d())<<6|63&d(),t-=2):(r=(15&r)<<18|(63&d())<<12|(63&d())<<6|63&d(),t-=3)),r<65536?e.push(r):(r-=65536,e.push(55296|r>>10),e.push(56320|1023&r))}}"function"!=typeof t&&(t=function(e){return e}),"function"!=typeof s&&(s=function(){return n});var x=function e(){var l,h,x=d(),p=x>>5,b=31&x;if(7===p)switch(b){case 25:return function(){var e=new ArrayBuffer(4),t=new DataView(e),s=c(),r=32768&s,a=31744&s,i=1023&s;if(31744===a)a=261120;else if(0!==a)a+=114688;else if(0!==i)return(r?-1:1)*i*5.960464477539063e-8;return t.setUint32(0,r<<16|a<<13|i<<13),t.getFloat32(0)}();case 26:return i(4,r.getFloat32(a));case 27:return i(8,r.getFloat64(a))}if((h=u(b))<0&&(p<2||6<p))throw"Invalid length";switch(p){case 0:return h;case 1:return-1-h;case 2:if(h<0){for(var y=[],w=0;(h=m(p))>=0;)w+=h,y.push(o(h));var v=new Uint8Array(w),k=0;for(l=0;l<y.length;++l)v.set(y[l],k),k+=y[l].length;return v}return o(h);case 3:var N=[];if(h<0)for(;(h=m(p))>=0;)f(N,h);else f(N,h);return String.fromCharCode.apply(null,N);case 4:var j;if(h<0)for(j=[];!g();)j.push(e());else for(j=new Array(h),l=0;l<h;++l)j[l]=e();return j;case 5:var _={};for(l=0;l<h||h<0&&!g();++l){_[e()]=e()}return _;case 6:return t(e(),h);case 7:switch(h){case 20:return!1;case 21:return!0;case 22:return null;case 23:return n;default:return s(h)}}}();if(a!==e.byteLength)throw"Remaining bytes";return x}})?r.call(t,s,t,e):r)===n||(e.exports=a)}()},7277:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>k});var r=s(6540),a=s(6393),i=s(4848);const n=e=>{let{firmwares:t,isFetchingFirmwares:s,onFetchFirmwares:a,onDownloadFirmware:n,isConnected:l=!1}=e;const[o,d]=(0,r.useState)({}),c=t.reduce(((e,t)=>(e[t.branch]||(e[t.branch]=[]),e[t.branch].push(t),e)),{});return(0,i.jsx)("div",{className:"space-y-3",children:s?(0,i.jsxs)("div",{className:"text-center py-6",children:[(0,i.jsx)("div",{className:"inline-flex items-center justify-center w-6 h-6 bg-zswatch-secondary rounded-full animate-spin mb-2",children:(0,i.jsx)("span",{className:"text-white text-xs",children:"\u23f3"})}),(0,i.jsx)("p",{className:"text-gray-700 dark:text-white text-sm",children:"Loading firmwares..."})]}):0===t.length?(0,i.jsxs)("div",{className:"text-center py-6 bg-gray-50 dark:bg-black/20 border border-gray-200 dark:border-white/10 rounded-lg",children:[(0,i.jsx)("span",{className:"text-2xl mb-2 block",children:"\ud83d\udce6"}),(0,i.jsx)("p",{className:"text-gray-700 dark:text-white text-sm",children:"No firmwares fetched yet"}),(0,i.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:'Click "Fetch Latest" to get builds'})]}):(0,i.jsx)("div",{className:"space-y-2",children:Object.entries(c).map((e=>{let[t,s]=e;return(0,i.jsxs)("div",{className:"border border-gray-200 dark:border-white/10 rounded-lg overflow-hidden",children:[(0,i.jsx)("div",{className:"bg-gray-50 dark:bg-black/20 px-3 py-2 border-b border-gray-200 dark:border-white/10",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t}),"main"===t&&(0,i.jsx)("span",{className:"text-xs bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 px-2 py-1 rounded-full",children:"Release"}),"main"!==t&&(0,i.jsx)("span",{className:"text-xs bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 px-2 py-1 rounded-full",children:"Debug"})]}),(0,i.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[s.length," build",1!==s.length?"s":""]})]})}),(0,i.jsx)("div",{className:"space-y-1",children:s.map(((e,s)=>{const r=`${t}-${s}`;return(0,i.jsxs)("div",{className:"border-b border-gray-100 dark:border-white/5 last:border-b-0",children:[(0,i.jsxs)("button",{onClick:()=>(e=>{d((t=>({...t,[e]:!t[e]})))})(r),className:"w-full flex items-center justify-between p-2 bg-gray-100 dark:bg-white/10 hover:bg-gray-200 dark:hover:bg-white/15 transition-all",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2 text-left",children:[(0,i.jsxs)("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:["by ",e.user]}),(0,i.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[e.artifacts.length," artifact",1!==e.artifacts.length?"s":""]})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:["main"===t&&0===s&&(0,i.jsx)("button",{onClick:t=>{t.stopPropagation(),e.artifacts.length>0&&n(e.runId,e.artifacts[0].id)},className:"bg-zswatch-primary text-black px-2 py-1 rounded text-xs font-medium hover:bg-zswatch-primary/90 transition-all",children:"Quick Download"}),(0,i.jsx)("span",{className:"text-xs transition-transform "+(o[r]?"rotate-180":""),children:"\u25bc"})]})]}),o[r]&&(0,i.jsx)("div",{className:"px-3 pb-2",children:(0,i.jsx)("div",{className:"space-y-1",children:e.artifacts.map(((t,s)=>(0,i.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-white/5 hover:bg-gray-100 dark:hover:bg-white/10 rounded border border-gray-200 dark:border-white/10 transition-colors",children:[(0,i.jsx)("span",{className:"text-xs text-gray-700 dark:text-gray-300 font-mono",children:t.name}),(0,i.jsx)("button",{onClick:()=>n(e.runId,t.id),className:"bg-zswatch-primary text-black px-2 py-1 rounded text-xs font-medium hover:bg-zswatch-primary/90 transition-all",children:"Download"})]},s)))})})]},s)}))})]},t)}))})})},l=e=>{let{fileInputRef:t,fileStatus:s,fileUploadPercentage:a,fileUploadSpeed:n,fileInfos:l,isFileUploadInProgress:o,onFileChange:d,onFileUpload:c,onEraseFiles:h,onConfirmFiles:g,onClearFiles:u,isConnected:m=!1}=e;const[f,x]=r.useState(!1);return(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("input",{type:"file",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10",onChange:d,ref:t,accept:".zip,.bin"}),(0,i.jsx)("div",{className:`\n            relative border-2 border-dashed rounded-xl p-4 text-center transition-all duration-200\n            ${f?"border-zswatch-primary bg-zswatch-primary/5 scale-105":"border-gray-300 dark:border-gray-600 hover:border-zswatch-primary/50 hover:bg-zswatch-primary/5"}\n          `,onDragOver:e=>{e.preventDefault(),x(!0)},onDragLeave:e=>{e.preventDefault(),x(!1)},onDrop:e=>{if(e.preventDefault(),x(!1),e.dataTransfer.files.length>0){const t={target:{files:e.dataTransfer.files}};d(t)}},children:(0,i.jsxs)("div",{className:"transition-all duration-200 "+(f?"scale-110":""),children:[(0,i.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:f?"Drop your files here":"Upload Firmware Files"}),(0,i.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Drag and drop your .bin or .zip files here"})]})})]}),null!==a&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,i.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Upload Progress"}),(0,i.jsxs)("span",{className:"font-medium text-gray-900 dark:text-white",children:[a,"%"]})]}),(0,i.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3",children:(0,i.jsx)("div",{className:"bg-gradient-to-r from-zswatch-secondary to-zswatch-primary h-3 rounded-full transition-all duration-300 relative overflow-hidden",style:{width:`${a}%`},children:(0,i.jsx)("div",{className:"absolute inset-0 bg-white/20 animate-pulse"})})}),n&&(0,i.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 text-right",children:[n," KB/s"]})]}),l&&l.length>0&&(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)("div",{className:"flex items-center gap-2",children:(0,i.jsxs)("h4",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["\ud83d\udccb Files (",l.length,")",s&&"Select image files (.bin or .zip)"!==s&&(0,i.jsxs)("span",{className:"ml-2 text-xs text-gray-600 dark:text-gray-400",children:["- ",s]})]})}),(0,i.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3",children:l.map(((e,t)=>{return(0,i.jsx)("div",{className:"bg-white dark:bg-white/5 border border-gray-200 dark:border-white/10 rounded-lg p-3",children:(0,i.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,i.jsxs)("div",{className:"flex items-start gap-2 min-w-0 flex-1",children:[(0,i.jsx)("span",{className:"text-sm mt-0.5",children:"\ud83d\udcc4"}),(0,i.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,i.jsx)("h5",{className:"font-medium text-gray-900 dark:text-white text-sm truncate mb-1",children:e.name}),(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3 text-xs text-gray-500 dark:text-gray-400",children:[(0,i.jsxs)("span",{className:"bg-gray-100 dark:bg-gray-700 px-1.5 py-0.5 rounded",children:["Image #",e.imageNumber]}),(0,i.jsxs)("span",{children:["v",e.version]})]}),(0,i.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:(s=e.fileSize,(s/1024).toFixed(1)+" KB")})]})]})]}),(0,i.jsxs)("div",{className:"flex flex-col items-end gap-1 flex-shrink-0 ml-2",children:[e.isUploaded&&(0,i.jsx)("span",{className:"bg-green-100 dark:bg-green-500/20 text-green-700 dark:text-green-400 px-2 py-1 rounded text-xs",children:"\u2705 Done"}),e.isUploading&&(0,i.jsxs)("span",{className:"bg-blue-100 dark:bg-blue-500/20 text-blue-700 dark:text-blue-400 px-2 py-1 rounded text-xs flex items-center gap-1",children:[(0,i.jsx)("div",{className:"w-2 h-2 border border-blue-500 border-t-transparent rounded-full animate-spin"}),e.uploadPercentage||0,"%"]})]})]})},t);var s}))})]}),(0,i.jsxs)("div",{className:"flex flex-wrap gap-3 mt-4",children:[(0,i.jsx)("button",{onClick:c,disabled:!l||0===l.length||o||!m,className:"flex-1 px-4 py-2 text-sm font-medium transition-all border rounded group bg-blue-50 dark:bg-blue-500/10 text-blue-700 dark:text-blue-400 border-blue-200 dark:border-blue-500/30 hover:bg-blue-100 dark:hover:bg-blue-500/20 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,i.jsx)("div",{className:"relative",children:o?"Uploading...":"Upload Firmware"})}),(0,i.jsx)("button",{onClick:h,disabled:!m,className:"flex-1 px-4 py-2 text-sm font-medium transition-all border rounded group bg-red-50 dark:bg-red-500/10 text-red-700 dark:text-red-400 border-red-200 dark:border-red-500/30 hover:bg-red-100 dark:hover:bg-red-500/20 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,i.jsx)("div",{className:"relative",children:"Erase Files"})}),(0,i.jsx)("button",{onClick:g,disabled:!m,className:"flex-1 px-4 py-2 text-sm font-medium transition-all border rounded group bg-gray-50 dark:bg-white/5 text-gray-700 dark:text-gray-300 border-gray-200 dark:border-white/10 hover:bg-gray-100 dark:hover:bg-white/10 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,i.jsx)("div",{className:"relative",children:"Confirm Files"})})]})]})},o=e=>{let{fileFsInputRef:t,fileSystemUploadStatus:s,fileSystemUploadProgress:a,onFileSystemSelection:n,onFileSystemUploadStart:l,isConnected:o=!1}=e;const[d,c]=(0,r.useState)(!1);return(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("input",{type:"file",ref:t,onChange:n,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10",accept:".bin"}),(0,i.jsx)("div",{className:`\n            relative border-2 border-dashed rounded-xl p-4 text-center transition-all duration-200\n            ${d?"border-zswatch-secondary bg-zswatch-secondary/5 scale-105":"border-gray-300 dark:border-gray-600 hover:border-zswatch-secondary/50 hover:bg-zswatch-secondary/5"}\n          `,onDragOver:e=>{e.preventDefault(),c(!0)},onDragLeave:e=>{e.preventDefault(),c(!1)},onDrop:e=>{if(e.preventDefault(),c(!1),e.dataTransfer.files.length>0){const t={target:{files:e.dataTransfer.files}};n(t)}},children:(0,i.jsxs)("div",{className:"transition-all duration-200 "+(d?"scale-110":""),children:[(0,i.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:d?"Drop your file system file here":"Upload File System"}),(0,i.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Drag and drop your .bin file here"})]})})]}),null!==a&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,i.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Upload Progress"}),(0,i.jsxs)("span",{className:"font-medium text-gray-900 dark:text-white",children:[a,"%"]})]}),(0,i.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3",children:(0,i.jsx)("div",{className:"bg-gradient-to-r from-zswatch-secondary to-zswatch-primary h-3 rounded-full transition-all duration-300 relative overflow-hidden",style:{width:`${a}%`},children:(0,i.jsx)("div",{className:"absolute inset-0 bg-white/20 animate-pulse"})})})]}),s&&"Select a filesystem file"!==s&&(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)("div",{className:"flex items-center gap-2",children:(0,i.jsxs)("h4",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["\ud83d\udccb File System",(0,i.jsxs)("span",{className:"ml-2 text-xs text-gray-600 dark:text-gray-400",children:["- ",s]})]})}),(0,i.jsx)("div",{className:"flex gap-3",children:(0,i.jsx)("button",{onClick:l,disabled:!o||null!==a,className:"flex-1 px-4 py-2 text-sm font-medium transition-all border rounded group bg-blue-50 dark:bg-blue-500/10 text-blue-700 dark:text-blue-400 border-blue-200 dark:border-blue-500/30 hover:bg-blue-100 dark:hover:bg-blue-500/20 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,i.jsx)("div",{className:"relative",children:null!==a?"Uploading...":"Upload File System"})})})]})]})};var d=s(1909),c=s.n(d);const h=class{constructor(e){void 0===e&&(e={}),this.SERVICE_UUID="8d53dc1d-1db7-4cd3-868b-8a527460aa84",this.CHARACTERISTIC_UUID="da2e7828-fbce-4e01-ae9e-261174997c48",this._mtu=244,this._netbuf_size=2450,this._device=null,this._service=null,this._characteristic=null,this._connectCallback=null,this._connectingCallback=null,this._disconnectCallback=null,this._messageCallback=null,this._imageUploadProgressCallback=null,this._uploadIsInProgress=!1,this._chunkTimeout=5e3,this._retryCount=0,this._buffer=new Uint8Array,this._logger=e.logger||{info:console.log,error:console.error},this._seq=0,this._userRequestedDisconnect=!1}async _requestDevice(e){console.log(e);const t={acceptAllDevices:!0,optionalServices:[6159,this.SERVICE_UUID]};return e&&(t.filters=e,t.acceptAllDevices=!1),navigator.bluetooth.requestDevice(t)}async connect(e){try{this._device=await this._requestDevice(e),this._logger.info(`Connecting to device ${this.name}...`),this._device.addEventListener("gattserverdisconnected",(async e=>{this._logger.info(e),this._userRequestedDisconnect?this._disconnected():(this._logger.info("Trying to reconnect"),this._connect(1e3))})),this._connect(0)}catch(t){return this._logger.error(t),void await this._disconnected()}}_connect(){setTimeout((async()=>{try{this._connectingCallback&&this._connectingCallback();const e=await this._device.gatt.connect();this._logger.info("Server connected."),this._service=await e.getPrimaryService(this.SERVICE_UUID),this._logger.info("Service connected."),this._characteristic=await this._service.getCharacteristic(this.CHARACTERISTIC_UUID),this._logger.info("Characteristic connected."),this._characteristic.addEventListener("characteristicvaluechanged",this._notification.bind(this)),this._logger.info("Notifications enabled."),await this._characteristic.startNotifications(),this._logger.info("Notifications started."),this._mtu=e.mtu||this._mtu,this._logger.info(`MTU size: ${this._mtu} bytes`),await this._connected(),this._logger.info("Connected."),this._uploadIsInProgress&&this._uploadNext()}catch(e){this._logger.error(e),await this._disconnected()}}),1e3)}disconnect(){return this._userRequestedDisconnect=!0,this._device.gatt.disconnect()}onConnecting(e){return this._connectingCallback=e,this}onConnect(e){return this._connectCallback=e,this}onDisconnect(e){return this._disconnectCallback=e,this}onMessage(e){return this._messageCallback=e,this}onImageUploadProgress(e){return this._imageUploadProgressCallback=e,this}onFsUploadProgress(e){return this._fsUploadProgressCallback=e,this}onImageUploadFinished(e){return this._imageUploadFinishedCallback=e,this}onFsUploadFinished(e){return this._fsUploadFinishedCallback=e,this}async _connected(){this._connectCallback&&this._connectCallback()}async _disconnected(){this._logger.info("Disconnected."),this._disconnectCallback&&this._disconnectCallback(),this._device=null,this._service=null,this._characteristic=null,this._uploadIsInProgress=!1,this._userRequestedDisconnect=!1}get name(){return this._device&&this._device.name}sleep(e){return new Promise((t=>setTimeout(t,e)))}splitBuffer(e,t){void 0===t&&(t=20);const s=[],r=new Uint8Array(e);for(let a=0;a<r.length;a+=t)s.push(r.slice(a,a+t));return s}async writeLargeBuffer(e,t,s,r){void 0===s&&(s=20),void 0===r&&(r=1);const a=this.splitBuffer(e,s);for(const n of a){try{t.writeValueWithoutResponse(n)}catch(i){console.warn("Write failed:",i),await this.sleep(2*r);continue}await this.sleep(r)}}async _sendMessage(e,t,s,r){let a=[];void 0!==r&&(a=[...new Uint8Array(c().encode(r))]);const i=255&a.length,n=[e,0,a.length>>8,i,t>>8,255&t,this._seq,s,...a];this.writeLargeBuffer(Uint8Array.from(n),this._characteristic,this._mtu,5),this._seq=(this._seq+1)%256}_notification(e){const t=new Uint8Array(e.target.value.buffer||e.target.value);this._buffer=new Uint8Array([...this._buffer,...t]);const s=256*this._buffer[2]+this._buffer[3];this._buffer.length<s+8||(this._processMessage(this._buffer.slice(0,s+8)),this._buffer=this._buffer.slice(s+8))}_processMessage(e){const[t,s,r,a,i,n,l,o]=e,d=c().decode(e.slice(8).buffer),h=256*r+a,g=256*i+n;if(1===g&&1===o&&(0===d.rc||void 0===d.rc)&&d.off)return this._uploadTimeout&&clearTimeout(this._uploadTimeout),this._uploadOffset=d.off,this._uploadIsInProgress&&this._uploadNext(),void(this._retryCount=0);if(8===g&&0===o){if((0===d.rc||void 0===d.rc)&&d.off)return this._uploadTimeout&&(clearTimeout(this._uploadTimeout),console.log("Upload timeout cleared")),this._uploadOffset=d.off,this._uploadIsInProgress&&this._uploadNextFileSystem(),void(this._retryCount=0);0!==d.rc&&(this._logger.error("Error uploading file:",d.rc),this._uploadTimeout&&(clearTimeout(this._uploadTimeout),console.log("Upload timeout cleared")),this._retryCount<3?(this._logger.info("Retrying upload..."),this._retryCount++,this._uploadNextFileSystem()):(this._logger.error("Upload failed after 3 retries"),this._uploadIsInProgress&&(this._fsUploadFinishedCallback(!1),this._uploadIsInProgress=!1)))}this._messageCallback&&this._messageCallback({op:t,group:g,id:o,data:d,length:h})}cmdReset(){return this._sendMessage(2,0,5)}smpEcho(e){return this._sendMessage(2,0,0,{d:e})}cmdImageState(){return this._sendMessage(0,1,0)}cmdImageErase(e){return void 0===e&&(e=1),this._sendMessage(2,1,5)}cmdImageTest(e){return this._sendMessage(2,1,0,{hash:e,confirm:!1})}cmdImageConfirm(e){return this._sendMessage(2,1,0,{hash:e,confirm:!0})}_hash(e){return crypto.subtle.digest("SHA-256",e)}async _uploadNext(){if(this._uploadOffset>=this._uploadImage.byteLength||!this._uploadIsInProgress)return this._uploadIsInProgress=!1,void this._imageUploadFinishedCallback();this._uploadTimeout&&clearTimeout(this._uploadTimeout),this._uploadTimeout=setTimeout((()=>{this._logger.info("Upload chunk timeout, retry"),this._uploadNext()}),this._chunkTimeout);const e={data:new Uint8Array,off:this._uploadOffset,image:this._uploadImageNumber};0===this._uploadOffset&&(e.len=this._uploadImage.byteLength,e.sha=new Uint8Array(await this._hash(this._uploadImage))),this._imageUploadProgressCallback({percentage:Math.floor(this._uploadOffset/this._uploadImage.byteLength*100)});const t=this._mtu-c().encode(e).byteLength-8;e.data=new Uint8Array(this._uploadImage.slice(this._uploadOffset,this._uploadOffset+t));try{await this._sendMessage(2,1,1,e)}catch(s){return this._logger.error("Error sending upload message:",s),void clearTimeout(this._uploadTimeout)}}async cmdUpload(e,t,s){void 0===t&&(t=0),void 0===s&&(s=0),this._uploadIsInProgress?this._logger.error("Upload is already in progress."):(this._logger.info(`Starting upload of image ${t}...`),this._uploadIsInProgress=!0,this._logger.info(`Image size: ${e.byteLength} bytes`),this._logger.info(`MTU size: ${this._mtu} bytes`),this._uploadOffset=0,this._retryCount=0,this._uploadImage=e,this._uploadImageNumber=t,this._uploadSlot=s,this._uploadNext())}async imageInfo(e){const t={},s=new Uint8Array(e);if(s.length<32)throw new Error("Invalid image (too short file)");if(61!==s[0]||184!==s[1]||243!==s[2]||150!==s[3])throw new Error("Invalid image (wrong magic bytes)");if(0!==s[4]||0!==s[5]||0!==s[6]||0!==s[7])throw new Error("Invalid image (wrong load address)");const r=s[8]+256*s[9];if(0!==s[10]||0!==s[11])throw new Error("Invalid image (wrong protected TLV area size)");const a=s[12]+256*s[13]+65536*s[14]+s[15]*2**24;if(t.imageSize=a,s.length<a+r)throw new Error("Invalid image (wrong image size)");if(0!==s[16]||0!==s[17]||0!==s[18]||0!==s[19])throw new Error("Invalid image (wrong flags)");const i=`${s[20]}.${s[21]}.${s[22]+256*s[23]}`;return t.version=i,t.hash=[...new Uint8Array(await this._hash(e.slice(0,a+r)))].map((e=>e.toString(16).padStart(2,"0"))).join(""),t}async cmdUploadFileSystemImage(e,t){this._uploadIsInProgress?this._logger.error("Upload is already in progress."):(this._logger.info(`Starting upload of image to ${t}... of ${e.byteLength} bytes`),this._uploadIsInProgress=!0,this._logger.info(`Image size: ${e.byteLength} bytes`),this._logger.info(`MTU size: ${this._mtu} bytes`),this._uploadOffset=0,this._retryCount=0,this._uploadImage=e,this._uploadName=t,this._uploadNextFileSystem())}async _uploadNextFileSystem(){if(this._uploadOffset>=this._uploadImage.byteLength||!this._uploadIsInProgress)return this._uploadIsInProgress=!1,console.log("Upload finished"),void this._fsUploadFinishedCallback(!0);this._uploadTimeout&&clearTimeout(this._uploadTimeout),this._uploadTimeout=setTimeout((()=>{this._logger.info("Upload chunk timeout, retry"),this._uploadNextFileSystem()}),this._chunkTimeout);const e={data:new Uint8Array,off:this._uploadOffset,name:this._uploadName};0===this._uploadOffset&&(e.len=this._uploadImage.byteLength),this._fsUploadProgressCallback({percentage:Math.floor(this._uploadOffset/this._uploadImage.byteLength*100)});let t=this._netbuf_size-c().encode(e).byteLength-20;t-=t%4,console.log("File offset",this._uploadOffset),e.data=new Uint8Array(this._uploadImage.slice(this._uploadOffset,this._uploadOffset+t));try{this._sendMessage(2,8,0,e)}catch(s){return this._logger.error("Error sending upload message:",s),void clearTimeout(this._uploadTimeout)}}};var g=s(797);const u={"app.internal.bin":0,"ipc_radio.bin":1,"app.external.bin":2},m="initial",f="connecting",x="connected",p="connected_advanced";var b=s(1710),y=s.n(b);const w=(e,t)=>{const[s,a]=(0,r.useState)(null),[i,n]=(0,r.useState)(null),[l,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)([]),[h,g]=(0,r.useState)("Select image files (.bin or .zip)"),m=(0,r.useRef)(null),f=(0,r.useRef)(null),x=(0,r.useRef)(null),p=(0,r.useRef)(null),b=(0,r.useRef)(0),w=async t=>{if(t){o(!0),a(0),n(null),g("Uploading..."),p.current=t.fileSize,f.current=Date.now(),x.current=Date.now(),b.current=0;try{await e.cmdUpload(t.fileData,t.imageNumber),o(!1),c((e=>e.map((e=>e===t?{...e,isUploading:!0}:e))))}catch(s){g("Upload failed"),o(!1)}}else g("Ready to upload")},v=async()=>{if(window.confirm("Do you want to confirm the images and restart the device? After confirming, you need to restart the device to apply the changes."))for(const t of d){const s=Uint8Array.from(t.hash.match(/.{1,2}/g).map((e=>parseInt(e,16))));await e.cmdImageTest(s)}};return{fileUploadPercentage:s,fileUploadSpeed:i,isFileUploadInProgress:l,fileInfos:d,fileStatus:h,setFileStatus:g,fileInputRef:m,handleFileChange:t=>{const s=t.target.files[0];if(!s)return void g("No file selected");g(`Processing ${s.name}...`);const r=new FileReader;r.onload=async()=>{"application/zip"===s.type?await(async(t,s)=>{const r=new(y());try{const t=await r.loadAsync(s.result),a=await Promise.all(Object.keys(t.files).filter((e=>e.endsWith(".bin"))).map((async s=>{const r=await t.files[s].async("arraybuffer"),a=u[s];if(null==a)return alert(`Invalid file: ${s}. Please use a valid binary file name.`),null;const i=await e.imageInfo(r);return{version:i.version,hash:i.hash,fileSize:r.byteLength,imageNumber:a,fileData:r,name:s,isUploaded:!1,isUploading:!1,isSetPending:!1,mcuMgrImageStatus:""}})));c((e=>[...e.filter((e=>!a.some((t=>t&&t.imageNumber===e.imageNumber)))),...a.filter((e=>null!==e))])),g("Zip file processed - Ready to upload")}catch(a){console.error("Error reading zip file:",a),g("Invalid zip file")}})(0,r):await(async(t,s)=>{let r=u[t.name];if(null==r&&(r=parseInt(prompt("Enter the image number:","0"),10),isNaN(r)||r<0))return alert("Invalid image number. Please enter a non-negative integer."),void g("Ready to upload");try{const a=await e.imageInfo(s.result);c((e=>[...e.filter((e=>e.imageNumber!==r)),{version:a.version,hash:a.hash,fileSize:s.result.byteLength,imageNumber:r,fileData:s.result,name:t.name,isUploaded:!1,isUploading:!1,isSetPending:!1,mcuMgrImageStatus:""}])),g("Binary file processed - Ready to upload")}catch(a){console.error("Error reading file:",a),g("Invalid image file")}})(s,r),e.cmdImageState()},r.readAsArrayBuffer(s)},handleFileUpload:async()=>{if(d.length<=0)o(!1);else if(d[0].fileData){const e=d.find((e=>!e.isUploaded));e?w(e):(g("All files uploaded"),o(!1),v())}},clearFiles:()=>{c([]),g("Select image files (.bin or .zip)"),m.current&&(m.current.value="")},setupUploadListeners:()=>{e&&(e.onImageUploadProgress((e=>{let{percentage:t}=e;g(`Uploading... ${t}%`),a(t);const s=Date.now(),r=(s-x.current)/1e3,i=t-b.current;if(i>0&&p.current){const e=i/100*p.current;n((e/1024/r).toFixed(2)),x.current=s,b.current=t}})),e.onImageUploadFinished((()=>{g("Upload complete"),n(null),console.log("File upload finished",d);const t=d.find((e=>!e.isUploaded&&!e.isUploading));t?w(t):(console.log("All files uploaded"),e.cmdImageState(),v()),c((e=>e.map((e=>e.isUploading?{...e,isUploaded:!0,isUploading:!1}:e))))})))},setFileInfos:c}},v=e=>{const[t,s]=(0,r.useState)([]),[a,i]=(0,r.useState)(!1);return{firmwares:t,isFetchingFirmwares:a,fetchAndSetFirmwares:async t=>{i(!0);const r=await async function(e,t){void 0===t&&(t=5);let s=[];try{const{owner:r,repo:a,token:i}=e,n=await fetch(`https://api.github.com/repos/${r}/${a}/actions/runs`,i?{headers:{Authorization:`Bearer ${i}`}}:{}),l=await n.json();if(!l.workflow_runs||0===l.workflow_runs.length)return console.log("No workflow runs found."),[];console.log("Found",l,l.workflow_runs.length,"workflow runs.");const o=l.workflow_runs.filter((e=>"success"===e.conclusion&&"gh-pages"!==e.head_branch)).slice(0,t);console.log(`Fetching artifacts from the latest ${t} workflow runs...`);for(const e of o){console.log(`Processing workflow run: ${e.id} (${e.name})`,e);const t=await fetch(`https://api.github.com/repos/${r}/${a}/actions/runs/${e.id}/artifacts`,i?{headers:{Authorization:`Bearer ${i}`}}:{}),n=await t.json();if(!n.artifacts||0===n.artifacts.length){console.log(`No artifacts found for workflow run: ${e.id}`);continue}const l={branch:e.head_branch,user:e.actor.login,runId:e.id,artifacts:n.artifacts.filter((e=>e.name.includes("@4")||e.name.includes("@5")))};s.push(l)}}catch(r){console.error("Error fetching artifacts:",r)}return s}(e,t);console.log("Fetched firmwares:",r),r&&s(r),i(!1)},downloadAndFlashFirmware:async(t,s,r)=>{try{r("Downloading firmware..."),r("Firmware download started. Please check your browser's downloads."),((e,t,s)=>{const r=`https://github.com/${e.owner}/${e.repo}/actions/runs/${t}/artifacts/${s}`;console.log("Download URL:",r),window.location.href=r})(e,t,s)}catch(a){console.error("Error downloading or flashing firmware:",a),r("Failed to download firmware.")}}}},k=()=>{const e=(()=>{const{siteConfig:e}=(0,g.A)();return{owner:"ZSWatch",repo:"ZSWatch",token:e.customFields.githubToken||""}})(),{mcumgr:t,deviceName:s,screen:d,images:c,bluetoothAvailable:u,setScreen:b,handleDeviceNameChange:y,handleConnect:k,handleDisconnect:N}=(()=>{const[e,t]=(0,r.useState)("ZSWatch"),[s,a]=(0,r.useState)(m),[i,n]=(0,r.useState)([]),[l,o]=(0,r.useState)(!1),d=(0,r.useRef)(new h).current;return(0,r.useEffect)((()=>{const e=navigator?.bluetooth?.getAvailability()||!1;o(e);const s=localStorage.getItem("deviceName");s&&t(s),d.onConnecting((()=>{a(f)})),d.onConnect((()=>{t(d.name),a(x),d.cmdImageState()})),d.onDisconnect((()=>{a(m)})),d.onMessage((e=>{let{group:t,id:s,data:r}=e;switch(t){case 0:switch(s){case 0:alert(r.r);break;case 2:console.table(r.tasks);break;case 3:console.log(r)}break;case 1:0===s&&n(r.images||[]);break;default:console.log("Unknown group")}}))}),[d]),{mcumgr:d,deviceName:e,screen:s,images:i,bluetoothAvailable:l,setScreen:a,handleDeviceNameChange:e=>{t(e),localStorage.setItem("deviceName",e)},handleConnect:async()=>{const t=e?[{namePrefix:e}]:null;await d.connect(t)},handleDisconnect:async()=>{await d.disconnect()}}})(),{fileUploadPercentage:j,fileUploadSpeed:_,isFileUploadInProgress:U,fileInfos:I,fileStatus:S,setFileStatus:F,fileInputRef:C,handleFileChange:D,handleFileUpload:A,clearFiles:z,setupUploadListeners:P,setFileInfos:T}=w(t),{fileSystemUploadProgress:R,fileSystemUploadStatus:E,fileFsInputRef:$,selectedFile:L,handleFileSystemSelection:O,startFileSystemUpload:B,setupFileSystemListeners:M}=(e=>{const[t,s]=(0,r.useState)(null),[a,i]=(0,r.useState)("Select a filesystem file"),[n,l]=(0,r.useState)(null),o=(0,r.useRef)(null);return{fileSystemUploadProgress:t,fileSystemUploadStatus:a,fileFsInputRef:o,selectedFile:n,handleFileSystemSelection:e=>{const t=e.target.files[0];if(!t)return i("No file selected"),void l(null);console.log("Selected file:",t),l(t),i(`File selected: ${t.name} - Ready to upload`)},startFileSystemUpload:async()=>{if(!n)return void i("No file selected");const t=new FileReader;t.onload=async r=>{i("Uploading..."),s(0);try{await e.cmdUploadFileSystemImage(t.result,"/S/full_fs"),i("Upload started")}catch(a){console.error("Filesystem upload failed:",a),i("Upload failed"),s(null)}o.current.value=null,l(null)},t.readAsArrayBuffer(n)},setupFileSystemListeners:()=>{e&&(e.onFsUploadProgress((e=>{let{percentage:t}=e;s(t)})),e.onFsUploadFinished((e=>{i(e?"Upload complete":"Upload failed"),s(null)})))}}})(t),{firmwares:q,isFetchingFirmwares:V,fetchAndSetFirmwares:W,downloadAndFlashFirmware:Z}=v(e);(0,r.useEffect)((()=>{t&&(P(),M())}),[P,M,t]);const H=(e,t)=>{Z(e,t,F)},K=()=>{const e=prompt("Enter a text message to send","Hello World!");e&&t&&t.smpEcho(e)},Y=()=>{t&&t.cmdReset()},G=()=>{const e=d===x||d===p,r=d===f;return(0,i.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-8 xl:grid-cols-11 gap-6",children:[(0,i.jsxs)("div",{className:"lg:col-span-2 xl:col-span-3 space-y-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-3",children:"Connection"}),(0,i.jsx)("div",{className:"border-b border-gray-200 dark:border-white/20 mb-4"}),(0,i.jsxs)("div",{className:"bg-white dark:bg-white/5 backdrop-blur-sm rounded-lg p-6 shadow-sm",children:[(0,i.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,i.jsx)("div",{className:"px-2 py-1 rounded-full text-xs font-medium "+(e?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300":r?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-300 animate-pulse":"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300"),children:e?"Connected":r?"Connecting...":"Disconnected"})}),(0,i.jsx)("div",{className:"p-3 rounded-lg mb-4 "+(u?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800"),children:(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("span",{className:"mr-2",children:u?"\u2705":"\u274c"}),(0,i.jsxs)("span",{className:"text-sm font-medium "+(u?"text-green-800 dark:text-green-300":"text-red-800 dark:text-red-300"),children:["Bluetooth ",u?"Available":"Not Available"]})]})}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Device name"}),(0,i.jsx)("input",{type:"text",value:s,onChange:e=>y(e.target.value),disabled:e||!u,className:"w-full bg-white dark:bg-black/30 border border-gray-300 dark:border-white/20 rounded-lg px-3 py-2 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:border-zswatch-primary focus:outline-none focus:ring-2 focus:ring-zswatch-primary/50 transition-all disabled:opacity-50 disabled:cursor-not-allowed text-sm",placeholder:"ZSWatch"})]}),(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[e?(0,i.jsxs)("button",{onClick:N,className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-100 dark:bg-red-500/20 text-red-700 dark:text-red-400 rounded-lg border border-red-300 dark:border-red-500/30 hover:bg-red-200 dark:hover:bg-red-500/30 transition-all",children:[(0,i.jsx)("span",{className:"text-sm",children:"\ud83d\udd0c"}),"Disconnect"]}):(0,i.jsx)("button",{onClick:k,disabled:!u||r,className:"px-4 py-2 bg-zswatch-primary text-black rounded-lg font-medium hover:bg-zswatch-primary/90 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:r?"Connecting...":"Connect"}),e&&(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsxs)("button",{onClick:K,className:"flex-1 flex items-center justify-center gap-1 px-3 py-2 bg-gray-100 dark:bg-white/10 text-gray-700 dark:text-white rounded-lg border border-gray-300 dark:border-white/20 hover:bg-gray-200 dark:hover:bg-white/20 transition-all text-sm",children:[(0,i.jsx)("span",{className:"text-xs",children:"\ud83d\udce2"}),"Echo"]}),(0,i.jsxs)("button",{onClick:Y,className:"flex-1 flex items-center justify-center gap-1 px-3 py-2 bg-gray-100 dark:bg-white/10 text-gray-700 dark:text-white rounded-lg border border-gray-300 dark:border-white/20 hover:bg-gray-200 dark:hover:bg-white/20 transition-all text-sm",children:[(0,i.jsx)("span",{className:"text-xs",children:"\ud83d\udd04"}),"Reset"]})]})]})]})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-3",children:"Browser Support"}),(0,i.jsx)("div",{className:"border-b border-gray-200 dark:border-white/20 mb-4"}),(0,i.jsx)("div",{className:"bg-white dark:bg-white/5 backdrop-blur-sm rounded-lg p-6 shadow-sm",children:(0,i.jsxs)("ul",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-300",style:{paddingLeft:0,paddingInlineStart:0,margin:0},children:[(0,i.jsxs)("li",{className:"flex items-center",children:[(0,i.jsx)("span",{className:"w-2 h-2 bg-green-500 rounded-full mr-3"}),"Chrome, Edge, Opera (Desktop)"]}),(0,i.jsxs)("li",{className:"flex items-center",children:[(0,i.jsx)("span",{className:"w-2 h-2 bg-green-500 rounded-full mr-3"}),"Chrome (Android)"]}),(0,i.jsxs)("li",{className:"flex items-center",children:[(0,i.jsx)("span",{className:"w-2 h-2 bg-yellow-500 rounded-full mr-3"}),"Bluefy (iOS/iPadOS)"]})]})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-3",children:"Troubleshooting"}),(0,i.jsx)("div",{className:"border-b border-gray-200 dark:border-white/20 mb-4"}),(0,i.jsx)("div",{className:"bg-white dark:bg-white/5 backdrop-blur-sm rounded-lg p-6 shadow-sm",children:(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("details",{className:"group",children:[(0,i.jsxs)("summary",{className:"flex items-center justify-between cursor-pointer text-gray-900 dark:text-white hover:text-zswatch-primary transition-colors text-sm",children:[(0,i.jsx)("span",{children:"Connection issues"}),(0,i.jsx)("span",{className:"group-open:rotate-180 transition-transform",children:"\u25bc"})]}),(0,i.jsxs)("div",{className:"mt-3 space-y-2 text-xs text-gray-600 dark:text-gray-300 pl-4 border-l-2 border-zswatch-primary/30",children:[(0,i.jsx)("p",{className:"m-0",children:"\u2022 Forget device in OS Bluetooth settings"}),(0,i.jsx)("p",{className:"m-0",children:"\u2022 Ensure watch is on"}),(0,i.jsx)("p",{className:"m-0",children:"\u2022 Use supported browser"})]})]}),(0,i.jsxs)("details",{className:"group",children:[(0,i.jsxs)("summary",{className:"flex items-center justify-between cursor-pointer text-gray-900 dark:text-white hover:text-zswatch-primary transition-colors text-sm",children:[(0,i.jsx)("span",{children:"Upload fails"}),(0,i.jsx)("span",{className:"group-open:rotate-180 transition-transform",children:"\u25bc"})]}),(0,i.jsxs)("div",{className:"mt-3 space-y-2 text-xs text-gray-600 dark:text-gray-300 pl-4 border-l-2 border-zswatch-primary/30",children:[(0,i.jsx)("p",{className:"m-0",children:"\u2022 Reset watch, reload page and reconnect"}),(0,i.jsx)("p",{className:"m-0",children:"\u2022 Check file format (.zip or .bin)"}),(0,i.jsx)("p",{className:"m-0",children:"\u2022 Fallback to USB (TBD instructions)"})]})]})]})})]})]}),(0,i.jsxs)("div",{className:"lg:col-span-3 xl:col-span-4 space-y-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-3",children:"Manual Upload"}),(0,i.jsx)("div",{className:"border-b border-gray-200 dark:border-white/20 mb-4"}),(0,i.jsx)("div",{className:"bg-white dark:bg-white/5 backdrop-blur-sm rounded-lg p-4 shadow-sm",children:(0,i.jsx)(l,{fileInputRef:C,fileStatus:S,fileUploadPercentage:j,fileUploadSpeed:_,fileInfos:I,isFileUploadInProgress:U,onFileChange:D,onFileUpload:A,onEraseFiles:()=>t&&t.cmdImageErase(),onConfirmFiles:()=>t&&t.cmdImageConfirm(),onClearFiles:z,isConnected:e})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-3",children:"File System"}),(0,i.jsx)("div",{className:"border-b border-gray-200 dark:border-white/20 mb-4"}),(0,i.jsx)("div",{className:"bg-white dark:bg-white/5 backdrop-blur-sm rounded-lg p-4 shadow-sm",children:(0,i.jsx)(o,{fileFsInputRef:$,fileSystemUploadStatus:E,fileSystemUploadProgress:R,onFileSystemSelection:O,onFileSystemUploadStart:B,isConnected:e})})]})]}),(0,i.jsxs)("div",{className:"lg:col-span-3 xl:col-span-4 space-y-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-3",children:"Prebuilt Firmware"}),(0,i.jsx)("div",{className:"border-b border-gray-200 dark:border-white/20 mb-4"}),(0,i.jsxs)("div",{className:"bg-white dark:bg-white/5 backdrop-blur-sm rounded-lg p-6 shadow-sm",children:[(0,i.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,i.jsxs)("button",{onClick:()=>W(6),disabled:V,className:"bg-zswatch-secondary/20 text-zswatch-secondary border border-zswatch-secondary/30 px-3 py-1 rounded text-sm hover:bg-zswatch-secondary/30 transition-all flex items-center gap-1",children:[(0,i.jsx)("span",{className:"text-xs",children:"\ud83d\udd04"}),V?"Fetching...":"Fetch Latest"]})}),(0,i.jsx)("p",{className:"text-gray-600 dark:text-gray-300 text-sm mb-4",children:"Download the latest firmware from GitHub Actions."}),(0,i.jsx)(n,{firmwares:q,isFetchingFirmwares:V,onFetchFirmwares:W,onDownloadFirmware:H,isConnected:e})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-1",children:"Images"}),(0,i.jsx)("div",{className:"border-b border-gray-200 dark:border-white/20 mb-2"}),(0,i.jsx)("div",{className:"bg-white dark:bg-white/5 backdrop-blur-sm rounded-lg p-6 shadow-sm",children:e?c&&c.length>0?(0,i.jsxs)("div",{className:"space-y-0",children:[c.map(((e,t)=>(0,i.jsx)("div",{className:"border rounded p-2 "+(e.active?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-500/30":"border-gray-200 dark:border-white/10"),children:(0,i.jsxs)("div",{className:"flex items-start justify-between",children:[(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsxs)("h4",{className:"font-medium text-gray-900 dark:text-white text-sm m-0 mb-1",children:["Image #",e.image," - Slot ",e.slot]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-x-4 gap-y-0 text-xs text-gray-500 dark:text-gray-400",children:[(0,i.jsxs)("div",{children:["Version: ",e.version||"Unknown"]}),(0,i.jsx)("div",{children:e.bootable?"Bootable":"Not Bootable"}),(0,i.jsxs)("div",{children:["Confirmed: ",e.confirmed?"Yes":"No"]}),(0,i.jsxs)("div",{children:["Pending: ",e.pending?"Yes":"No"]})]}),e.hash&&(0,i.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-mono mt-1",children:["Hash: ",Array.from(e.hash).map((e=>e.toString(16).padStart(2,"0"))).join("").substring(0,16),"..."]})]}),(0,i.jsxs)("div",{className:"flex flex-wrap gap-1 ml-2",children:[e.active&&(0,i.jsx)("span",{className:"text-xs bg-green-100 dark:bg-green-500/20 text-green-700 dark:text-green-400 px-2 py-0.5 rounded",children:"\u2705 Active"}),e.pending&&(0,i.jsx)("span",{className:"text-xs bg-yellow-100 dark:bg-yellow-500/20 text-yellow-700 dark:text-yellow-400 px-2 py-0.5 rounded",children:"\u23f3 Pending"}),e.confirmed&&(0,i.jsx)("span",{className:"text-xs bg-blue-100 dark:bg-blue-500/20 text-blue-700 dark:text-blue-400 px-2 py-0.5 rounded",children:"\u2713 Confirmed"}),e.permanent&&(0,i.jsx)("span",{className:"text-xs bg-purple-100 dark:bg-purple-500/20 text-purple-700 dark:text-purple-400 px-2 py-0.5 rounded",children:"\ud83d\udccc Permanent"})]})]})},t))),(0,i.jsxs)("div",{className:"flex gap-2 pt-3 border-t border-gray-200 dark:border-white/10",children:[(0,i.jsx)("button",{onClick:()=>t&&t.cmdImageState(),className:"flex-1 bg-gray-100 dark:bg-white/10 text-gray-700 dark:text-white px-3 py-2 rounded text-sm hover:bg-gray-200 dark:hover:bg-white/20 transition-all",children:"Refresh"}),(0,i.jsx)("button",{onClick:()=>t&&t.cmdImageTest(),className:"flex-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 px-3 py-2 rounded text-sm hover:bg-blue-200 dark:hover:bg-blue-900/50 transition-all",children:"Test"}),(0,i.jsx)("button",{onClick:()=>t&&t.cmdImageConfirm(),className:"flex-1 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 px-3 py-2 rounded text-sm hover:bg-green-200 dark:hover:bg-green-900/50 transition-all",children:"Confirm"}),(0,i.jsx)("button",{onClick:()=>t&&t.cmdImageErase(),className:"flex-1 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 px-3 py-2 rounded text-sm hover:bg-red-200 dark:hover:bg-red-900/50 transition-all",children:"Erase"})]}),(0,i.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2 flex items-center",children:[(0,i.jsx)("span",{className:"mr-1",children:"\ud83d\udd17"}),"Bluetooth connection required"]})]}):(0,i.jsxs)("div",{className:"text-center py-6",children:[(0,i.jsx)("div",{className:"text-gray-400 text-2xl mb-2",children:"\ud83d\udcf1"}),(0,i.jsx)("p",{className:"text-gray-600 dark:text-gray-300 text-sm",children:"No images found on device"})]}):(0,i.jsxs)("div",{className:"text-center py-6",children:[(0,i.jsx)("div",{className:"text-amber-500 text-2xl mb-2",children:"\u26a0\ufe0f"}),(0,i.jsx)("p",{className:"text-gray-600 dark:text-gray-300 text-sm",children:"Connect to device to view image status"})]})})]})]})]})};return(0,i.jsx)(a.A,{children:(0,i.jsx)("div",{className:"min-h-screen",style:{background:"linear-gradient(135deg, #1a1f2e 0%, var(--zswatch-darker) 30%, #2a2f3e 60%, #1a1f2e 100%)"},children:(0,i.jsxs)("div",{className:"container mx-auto px-2 py-8",children:[(0,i.jsxs)("div",{className:"text-center mb-8",children:[(0,i.jsx)("h1",{className:"text-4xl font-bold mb-2 text-gray-900 dark:text-gray-100",children:"ZSWatch Firmware Update"}),(0,i.jsx)("p",{className:"text-lg text-gray-600 dark:text-gray-300",children:"Update your ZSWatch firmware wirelessly over Bluetooth Low Energy"})]}),(0,i.jsx)("div",{className:"px-2 pb-8 max-w-7xl mx-auto",children:G()})]})})})}}}]);